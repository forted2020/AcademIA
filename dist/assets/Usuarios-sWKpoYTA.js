import{r as s,j as e}from"./index-CQcJGhZo.js";import"./PersonalStyles-ClmLj6MY.js";import{C as q}from"./index.esm-miwwEqOb.js";import{g as J,u as K,d as Q,e as W,f as Y,h as Z,c as _,A as ee,T as se,U as ae,a as te,M as j,b as oe,F as le}from"./ModalNewEdit-qToWFjjh.js";import{b as S,c as y,d as ie,e as M}from"./FileSaver.min-DpJHai7I.js";import{g as re,e as ne,f as de,d as ce}from"./api-KE1A3WEm.js";import{C as me}from"./CContainer-pv1BoYo7.js";import{C as ue,a as pe}from"./CCardBody-Da11kLgp.js";import{C as xe}from"./CCardHeader-BURm9XzE.js";import{C as Ce,a as w}from"./CRow-CCKjXgEG.js";import{a as be}from"./CButton-rOzXJk2W.js";import{C as he}from"./CCardFooter-BmPQ8Ysd.js";import"./CInputGroupText-DF-LoAY-.js";import"./Transition-BVVki2E3.js";import"./cil-arrow-top-BUn2wsuK.js";import"./CAccordionHeader-CeLgkaA3.js";import"./CFormSelect-b0EkHFBR.js";import"./CForm-CW-aKSWy.js";import"./CCloseButton-RnxG4z8J.js";import"./index-t--hEgTQ.js";const fe=[{id:"name",value:""},{id:"email",value:""},{id:"domicilio",value:""},{id:"telefono",value:""}],Ge=()=>{const[E,i]=s.useState([]),[x,C]=s.useState(""),[v,U]=s.useState(!1),[ge,je]=s.useState(!1),[b,h]=s.useState(fe),[Se,N]=s.useState(""),[ye,F]=s.useState(""),[Me,T]=s.useState(null),[R,n]=s.useState(!1),[D,d]=s.useState(null),[P,c]=s.useState(!1),[z,I]=s.useState(!1),[l,m]=s.useState(null),V=async()=>{try{const{data:a}=await re();i(a)}catch(a){console.error("Error fetching users:",a)}};s.useEffect(()=>{V()},[]);const A=async a=>{try{await ce(a),i(t=>t.filter(r=>r.id!==a)),n(!1),d(null),console.log(`Usuario con ID ${a} eliminado`)}catch(t){console.error("Error al eliminar: ",t)}},O=a=>{d(a),n(!0)},f=a=>{m(a),c(!0)},[k,B]=s.useState({pageIndex:0,pageSize:10}),[H,L]=s.useState([]),X=J(O,f),u=K({data:E,columns:X,getCoreRowModel:Z(),getPaginationRowModel:Y(),onPaginationChange:B,getSortedRowModel:W(),onSortingChange:L,getFilteredRowModel:Q(),onGlobalFilterChange:C,onColumnFiltersChange:h,state:{pagination:k,sorting:H,globalFilter:x,columnFilters:b}}),G=async a=>{var t,r;try{if(l){const o=await ne(l.id,a);i(p=>p.map(g=>g.id===l.id?o.data:g))}else{const o=await de(a);i(p=>[...p,o.data])}c(!1),m(null)}catch(o){console.error("Error al guardar usuario:",o),alert(((r=(t=o.response)==null?void 0:t.data)==null?void 0:r.detail)||"Error al guardar")}},$=()=>{N(""),F(""),T(null)};return e.jsxs(me,{children:[e.jsxs(ue,{className:"mb-1",children:["       ",e.jsx(xe,{className:"py-2 bg-white ",children:e.jsxs(Ce,{className:"justify-content-between align-items-center ",children:[" ",e.jsxs(w,{xs:12,sm:"auto",children:["    ",e.jsx("h4",{id:"titulo",className:"mb-0 ",children:"AdministraciÃ³n de Usuarios"}),e.jsx("div",{className:"small text-body-secondary",children:" Administradores del sistema"})]}),e.jsxs(w,{xs:12,sm:"auto",className:"text-md-end ",children:["  ",e.jsxs(be,{color:"primary",className:"shadow-sm",size:"sm",onClick:()=>f(""),children:[e.jsx(q,{icon:_,className:"me-1"}),"Nuevo"]})]})]})}),e.jsx(ee,{searchTerm:x,setSearchTerm:C,columnFilters:b,setColumnFilters:h}),e.jsx("div",{}),e.jsx(se,{table:u}),e.jsx(pe,{className:"px-4 pt-1 pb-2 border border-light",children:e.jsx(ae,{table:u})}),e.jsx(he,{className:"bg-white border-top px-3 py-1",style:{position:"sticky",bottom:0,zIndex:1,boxShadow:"0 -2px 5px rgba(0,0,0,0.1)"},children:e.jsx(te,{table:u})})]}),e.jsx(j,{visible:P,onClose:()=>{c(!1),m(null)},title:l?"Editar usuario":"Nuevo usuario",initialData:l||{name:"",domicilio:"",telefono:"",email:"",password:""},onSave:G}),e.jsx(oe,{visible:R,onClose:()=>{n(!1),d(null)},onConfirm:A,userId:D}),e.jsxs(S,{size:"xl",visible:v,onClose:()=>U(!1),"aria-labelledby":"OptionalSizesExample1",children:[e.jsx(y,{children:e.jsx(ie,{id:"OptionalSizesExample1",children:"Nuevo usuario"})}),e.jsxs(M,{children:[e.jsx(le,{}),"      "]})]}),e.jsxs(S,{id:"EditUserModal",size:"xl",visible:z,onClose:()=>{I(!1),$()},"aria-labelledby":"EditUserModal",children:[e.jsx(y,{}),e.jsx(M,{children:e.jsx(j,{})})]})]})};export{Ge as default};
