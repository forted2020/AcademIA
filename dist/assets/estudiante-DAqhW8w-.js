import{r as a,j as e}from"./index-CQcJGhZo.js";import{C as A}from"./index.esm-miwwEqOb.js";import{g as V,u as k,c as z,A as U,T as B,U as G,a as H,M as $,b as q,d as J,e as K,f as L,h as O}from"./ModalNewEdit-qToWFjjh.js";import{a as Q,b as W,u as X,c as Y}from"./api-KE1A3WEm.js";import{C as Z}from"./CContainer-pv1BoYo7.js";import{C as _,a as ee}from"./CCardBody-Da11kLgp.js";import{C as te}from"./CCardHeader-BURm9XzE.js";import{C as ae,a as E}from"./CRow-CCKjXgEG.js";import{a as se}from"./CButton-rOzXJk2W.js";import{C as oe}from"./CCardFooter-BmPQ8Ysd.js";import"./FileSaver.min-DpJHai7I.js";import"./CCloseButton-RnxG4z8J.js";import"./Transition-BVVki2E3.js";import"./CInputGroupText-DF-LoAY-.js";import"./cil-arrow-top-BUn2wsuK.js";import"./CAccordionHeader-CeLgkaA3.js";import"./CFormSelect-b0EkHFBR.js";import"./CForm-CW-aKSWy.js";import"./index-t--hEgTQ.js";const ie=[{id:"name",value:""},{id:"email",value:""},{id:"domicilio",value:""},{id:"telefono",value:""}];function Me(){const[j,r]=a.useState([]),[C,g]=a.useState(""),[x,b]=a.useState(ie),[S,w]=a.useState({pageIndex:0,pageSize:10}),[y,M]=a.useState([]),[N,n]=a.useState(!1),[v,d]=a.useState(null),[T,c]=a.useState(!1),[i,m]=a.useState(null);a.useEffect(()=>{R()},[]);const R=async()=>{try{const{data:t}=await Q();r(t)}catch(t){console.error("Error al obtener estudiantes:",t)}},F=async t=>{try{await W(t),r(s=>s.filter(l=>l.id!==t)),n(!1),d(null),console.log(`Estudiante con ID ${t} eliminado`)}catch(s){console.error("Error al eliminar estudiante:",s)}},D=t=>{d(t),n(!0)},h=t=>{m(t),c(!0)},P=async t=>{var s,l;try{if(i){const o=await X(i.id,t);r(p=>p.map(f=>f.id===i.id?o.data:f))}else{const o=await Y(t);r(p=>[...p,o.data])}c(!1),m(null)}catch(o){console.error("Error al guardar estudiante:",o),alert(((l=(s=o.response)==null?void 0:s.data)==null?void 0:l.detail)||"Error al guardar estudiante")}},I=V(D,h),u=k({data:j,columns:I,getCoreRowModel:O(),getPaginationRowModel:L(),onPaginationChange:w,getSortedRowModel:K(),onSortingChange:M,getFilteredRowModel:J(),onGlobalFilterChange:g,onColumnFiltersChange:b,state:{pagination:S,sorting:y,globalFilter:C,columnFilters:x}});return e.jsxs(Z,{children:[e.jsxs(_,{className:"mb-1",children:[e.jsx(te,{className:"py-2 bg-white",children:e.jsxs(ae,{className:"justify-content-between align-items-center",children:[e.jsxs(E,{xs:12,sm:"auto",children:[e.jsx("h4",{id:"titulo",className:"mb-0",children:"Gestión de Estudiantes"}),e.jsx("div",{className:"small text-body-secondary",children:"Administración de alumnos del establecimiento"})]}),e.jsx(E,{xs:12,sm:"auto",className:"text-md-end",children:e.jsxs(se,{color:"primary",className:"shadow-sm",size:"sm",onClick:()=>h(""),children:[e.jsx(A,{icon:z,className:"me-1"}),"Nuevo Estudiante"]})})]})}),e.jsx(U,{searchTerm:C,setSearchTerm:g,columnFilters:x,setColumnFilters:b}),e.jsx(B,{table:u}),e.jsx(ee,{className:"px-4 pt-1 pb-2 border border-light",children:e.jsx(G,{table:u})}),e.jsx(oe,{className:"bg-white border-top px-3 py-1",style:{position:"sticky",bottom:0,zIndex:1,boxShadow:"0 -2px 5px rgba(0,0,0,0.1)"},children:e.jsx(H,{table:u})})]}),e.jsx($,{visible:T,onClose:()=>{c(!1),m(null)},title:i?"Editar estudiante":"Nuevo estudiante",initialData:i||{name:"",domicilio:"",telefono:"",email:"",password:""},onSave:P}),e.jsx(q,{visible:N,onClose:()=>{n(!1),d(null)},onConfirm:F,userId:v})]})}export{Me as default};
